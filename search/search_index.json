{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"mezzio-cors CORS subcomponent for Mezzio . This extension creates CORS details for your application. Installation $ composer require mezzio/mezzio-cors Documentation Documentation is in the doc tree , and can be compiled using mkdocs : $ mkdocs build You may also browse the documentation online .","title":"Home"},{"location":"#mezzio-cors","text":"CORS subcomponent for Mezzio . This extension creates CORS details for your application.","title":"mezzio-cors"},{"location":"#installation","text":"$ composer require mezzio/mezzio-cors","title":"Installation"},{"location":"#documentation","text":"Documentation is in the doc tree , and can be compiled using mkdocs : $ mkdocs build You may also browse the documentation online .","title":"Documentation"},{"location":"v1/installation/","text":"This is only a placeholder. The content of this page can be found under: https://github.com/laminas/documentation-theme/blob/master/theme/pages/installation.html","title":"Installation"},{"location":"v1/intro/","text":"Introduction This component creates CORS details for your application. If the CorsMiddleware detects a CORS preflight , the middleware will start do detect the proper CORS configuration. The Router is being used to detect every allowed request method by executing a route match with all possible request methods. Therefore, for every preflight request, there is at least one Router request (depending on the configuration of the route, it might be just one or we are executing a check for every request method). Here is a list of the request methods being checked for the CORS preflight information: DELETE GET HEAD OPTIONS PATCH POST PUT TRACE The order of the headers might vary, depending on what request method is being requested with the CORS preflight request. In the end, the response contains every possible request method of the route due to what the router tells the ConfigurationLocator . The allowed origins can be configured as strings which can be matched with fnmatch . Therefore, wildcards are possible. Features mezzio-cors provides a CorsMiddleware which works out of the box with once created a global configuration file. It can safely be added to the projects pipeline as CORS details are needed for every request (in case its a CORS request). It uses the mezzio-router to match the incoming URI. It starts with the HTTP request method which is provided by the Request via the Access-Control-Request-Method header and checks all request methods until it matches a route. If that route states to be explicit, the response is created immediately. If the route is not explicit, all request methods are checked to provide a list of possible request methods to the client.","title":"Introduction"},{"location":"v1/intro/#introduction","text":"This component creates CORS details for your application. If the CorsMiddleware detects a CORS preflight , the middleware will start do detect the proper CORS configuration. The Router is being used to detect every allowed request method by executing a route match with all possible request methods. Therefore, for every preflight request, there is at least one Router request (depending on the configuration of the route, it might be just one or we are executing a check for every request method). Here is a list of the request methods being checked for the CORS preflight information: DELETE GET HEAD OPTIONS PATCH POST PUT TRACE The order of the headers might vary, depending on what request method is being requested with the CORS preflight request. In the end, the response contains every possible request method of the route due to what the router tells the ConfigurationLocator . The allowed origins can be configured as strings which can be matched with fnmatch . Therefore, wildcards are possible.","title":"Introduction"},{"location":"v1/intro/#features","text":"mezzio-cors provides a CorsMiddleware which works out of the box with once created a global configuration file. It can safely be added to the projects pipeline as CORS details are needed for every request (in case its a CORS request). It uses the mezzio-router to match the incoming URI. It starts with the HTTP request method which is provided by the Request via the Access-Control-Request-Method header and checks all request methods until it matches a route. If that route states to be explicit, the response is created immediately. If the route is not explicit, all request methods are checked to provide a list of possible request methods to the client.","title":"Features"},{"location":"v1/middleware/","text":"Middleware mezzio-cors provides middleware consuming PSR-7 HTTP message instances, via implementation of PSR-15 interfaces. This middleware checks, if the incoming request is a CORS request. If so, it makes a distinction between a so called Preflight request or the regular request . Preflight Request A Preflight request should be a light call which provides the Browser with the CORS informations it needs to execute the regular (CORS) request. These informations are: - Domain accepted for executing CORS request? - Cookies accepted? - Which Headers are allowed to be sent? - Which Headers are provided in the response? - Which HTTP Methods are accepted by that Endpoint? CORS Request The CORS request is the actual request. That request SHOULD to be already verified. If its not verified by a previous Preflight request , the request will be aborted with a 403 Forbidden response. Configuration There are 2 ways of configuring CORS in your project. Either create a global configuration file like cors.global.php or add a route specific configuration. On the project level, you can only configure the following Headers: Configuration Type Header allowed_origins string[] Access-Control-Allow-Origin allowed_headers string[] Access-Control-Allow-Headers allowed_max_age string (TTL in seconds) Access-Control-Allowed-Max-Age credentials_allowed bool Access-Control-Allow-Credentials exposed_headers string[] Access-Control-Exposed-Headers On the route level, you can configure all of the projects configuration settings and if the configuration of the route should either override the project configuration (default) or merge it. Configuration Type Header overrides_project_configuration bool - explicit bool - allowed_origins string[] Access-Control-Allow-Origin allowed_headers string[] Access-Control-Allow-Headers allowed_max_age string (TTL in seconds) Access-Control-Allowed-Max-Age credentials_allowed bool Access-Control-Allow-Credentials exposed_headers string[] Access-Control-Exposed-Headers The parameter overrides_project_configuration handles the way how the configuration is being merged. The default setting is true to ensure that a route configuration has to specify every information it will provide. The parameter explicit tells the ConfigurationLocator to stop trying other request methods to match the same route because there wont be any other method. Examples for Project Configurations Allow Every Origin &lt;?php // In config/autoload/cors.global.php declare(strict_types=1); use Mezzio\\Cors\\Configuration\\ConfigurationInterface; return [ ConfigurationInterface::CONFIGURATION_IDENTIFIER =&gt; [ 'allowed_origins' =&gt; [ConfigurationInterface::ANY_ORIGIN], // Allow any origin 'allowed_headers' =&gt; [], // No custom headers allowed 'allowed_max_age' =&gt; '600', // 10 minutes 'credentials_allowed' =&gt; true, // Allow cookies 'exposed_headers' =&gt; ['X-Custom-Header'], // Tell client that the API will always return this header ], ]; Allow Every Origin from a Specific Domain and Its Subdomains &lt;?php // In config/autoload/cors.global.php declare(strict_types=1); use Mezzio\\Cors\\Configuration\\ConfigurationInterface; return [ ConfigurationInterface::CONFIGURATION_IDENTIFIER =&gt; [ 'allowed_origins' =&gt; ['example.com', '*.example.com'], 'allowed_headers' =&gt; [], // No custom headers allowed 'allowed_max_age' =&gt; '3600', // 60 minutes 'credentials_allowed' =&gt; false, // Disallow cookies 'exposed_headers' =&gt; [], // No headers are exposed ], ]; Examples for Route Configurations Make the Configuration Explicit to Avoid Multiple Router Match Requests &lt;?php // In config/autoload/cors.global.php declare(strict_types=1); use Mezzio\\Cors\\Configuration\\ConfigurationInterface; use Mezzio\\Cors\\Configuration\\RouteConfigurationInterface; return [ ConfigurationInterface::CONFIGURATION_IDENTIFIER =&gt; [ 'allowed_origins' =&gt; ['example.com', '*.example.com'], 'allowed_headers' =&gt; ['X-Project-Header'], 'exposed_headers' =&gt; ['X-Some-Header'], 'allowed_max_age' =&gt; '3600', 'credentials_allowed' =&gt; true, ], 'routes' =&gt; [ [ 'name' =&gt; 'foo-get', 'path' =&gt; '/foo', 'middleware' =&gt; [ // ... ], 'options' =&gt; [ 'defaults' =&gt; [ RouteConfigurationInterface::PARAMETER_IDENTIFIER =&gt; [ 'explicit' =&gt; true, 'allowed_origins' =&gt; ['someotherdomain.com'], 'allowed_headers' =&gt; ['X-Specific-Header-For-Foo-Endpoint'], 'allowed_max_age' =&gt; '3600', ], ], ], 'allowed_methods' =&gt; ['GET'], ], [ 'name' =&gt; 'foo-delete', 'path' =&gt; '/foo', 'middleware' =&gt; [ // ... ], 'allowed_methods' =&gt; ['DELETE'], ], ], ]; Result of this configuration for the CORS preflight of /foo for the upcoming GET request will look like this: Configuration Parameter allowed_origins ['someotherdomain.com'] allowed_headers ['X-Specific-Header-For-Foo-Endpoint'] allowed_max_age 3600 exposed_headers [] credentials_allowed false allowed_methods ['GET'] Did you note the missing DELETE ? This is because of the explicit flag! Also note the empty exposed_headers which is due to the project overriding ( overrides_project_configuration ) parameter. Enable Project Merging &lt;?php declare(strict_types=1); use Mezzio\\Cors\\Configuration\\ConfigurationInterface; use Mezzio\\Cors\\Configuration\\RouteConfigurationInterface; return [ ConfigurationInterface::CONFIGURATION_IDENTIFIER =&gt; [ 'allowed_origins' =&gt; ['example.com', '*.example.com'], 'allowed_headers' =&gt; ['X-Project-Header'], 'exposed_headers' =&gt; ['X-Some-Header'], 'allowed_max_age' =&gt; '3600', ], 'routes' =&gt; [ [ 'name' =&gt; 'foo-get', 'path' =&gt; '/foo', 'middleware' =&gt; [ // ... ], 'options' =&gt; [ 'defaults' =&gt; [ RouteConfigurationInterface::PARAMETER_IDENTIFIER =&gt; [ 'overrides_project_configuration' =&gt; false, 'allowed_origins' =&gt; [RouteConfigurationInterface::ANY_ORIGIN], 'allowed_headers' =&gt; ['X-Specific-Header-For-Foo-Endpoint'], 'allowed_max_age' =&gt; '7200', 'credentials_allowed' =&gt; true, ], ], ], 'allowed_methods' =&gt; ['GET'], ], [ 'name' =&gt; 'foo-delete', 'path' =&gt; '/foo', 'middleware' =&gt; [ // ... ], 'allowed_methods' =&gt; ['DELETE'], ], ], ]; Result of this configuration for the CORS preflight of /foo for the upcoming GET request will look like this: Configuration Parameter allowed_origins [RouteConfigurationInterface::ANY_ORIGIN] allowed_headers ['X-Specific-Header-For-Foo-Endpoint', 'X-Project-Header'] allowed_max_age 7200 exposed_headers ['X-Some-Header'] credentials_allowed true allowed_methods ['GET', 'DELETE'] Did you note the ANY_ORIGIN detail? This is, because if ANY_ORIGIN is allowed for an endpoint, we remove all other origins for that route.","title":"Middleware"},{"location":"v1/middleware/#middleware","text":"mezzio-cors provides middleware consuming PSR-7 HTTP message instances, via implementation of PSR-15 interfaces. This middleware checks, if the incoming request is a CORS request. If so, it makes a distinction between a so called Preflight request or the regular request .","title":"Middleware"},{"location":"v1/middleware/#preflight-request","text":"A Preflight request should be a light call which provides the Browser with the CORS informations it needs to execute the regular (CORS) request. These informations are: - Domain accepted for executing CORS request? - Cookies accepted? - Which Headers are allowed to be sent? - Which Headers are provided in the response? - Which HTTP Methods are accepted by that Endpoint?","title":"Preflight Request"},{"location":"v1/middleware/#cors-request","text":"The CORS request is the actual request. That request SHOULD to be already verified. If its not verified by a previous Preflight request , the request will be aborted with a 403 Forbidden response.","title":"CORS Request"},{"location":"v1/middleware/#configuration","text":"There are 2 ways of configuring CORS in your project. Either create a global configuration file like cors.global.php or add a route specific configuration. On the project level, you can only configure the following Headers: Configuration Type Header allowed_origins string[] Access-Control-Allow-Origin allowed_headers string[] Access-Control-Allow-Headers allowed_max_age string (TTL in seconds) Access-Control-Allowed-Max-Age credentials_allowed bool Access-Control-Allow-Credentials exposed_headers string[] Access-Control-Exposed-Headers On the route level, you can configure all of the projects configuration settings and if the configuration of the route should either override the project configuration (default) or merge it. Configuration Type Header overrides_project_configuration bool - explicit bool - allowed_origins string[] Access-Control-Allow-Origin allowed_headers string[] Access-Control-Allow-Headers allowed_max_age string (TTL in seconds) Access-Control-Allowed-Max-Age credentials_allowed bool Access-Control-Allow-Credentials exposed_headers string[] Access-Control-Exposed-Headers The parameter overrides_project_configuration handles the way how the configuration is being merged. The default setting is true to ensure that a route configuration has to specify every information it will provide. The parameter explicit tells the ConfigurationLocator to stop trying other request methods to match the same route because there wont be any other method.","title":"Configuration"}]}